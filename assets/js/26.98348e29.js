(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{281:function(n,s,a){"use strict";a.r(s);var e=a(0),t=Object(e.a)({},function(){var n=this,s=n.$createElement,a=n._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h1",{attrs:{id:"react-dom-diff"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#react-dom-diff","aria-hidden":"true"}},[n._v("#")]),n._v(" React dom-diff")]),n._v(" "),a("p",[n._v("dom-diff 是通过 js 的计算返回一个 patch 对象，即补丁对象，通过特定的操作解析 patch 对象经行页面的重新渲染。")]),n._v(" "),a("p",[n._v("实现的步骤")]),n._v(" "),a("ol",[a("li",[n._v("js 对象转换成虚拟 DOM")]),n._v(" "),a("li",[n._v("虚拟 DOM 转换成真实 DOM 插入页面")]),n._v(" "),a("li",[n._v("有事件发生修改虚拟 DOM")]),n._v(" "),a("li",[n._v("比较两颗 DOM 树 找到差异对象")]),n._v(" "),a("li",[n._v("差异对象补丁到真实 DOM")])]),n._v(" "),a("h2",{attrs:{id:"简单实现虚拟-dom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简单实现虚拟-dom","aria-hidden":"true"}},[n._v("#")]),n._v(" 简单实现虚拟 DOM")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("//实现DOM 插入页面\nclass Element {\n    constructor(tarname, atts, children) {\n        this.tagname = tarname\n        this.attrs = atts\n        this.children = children || []\n    }\n    render() {\n        let element = document.createElement(this.tagname)\n        for (let attr in this.attrs) {\n            this.setAttr(element, attr, this.attrs[attr])\n        }\n        //先序深度优先遍历\n        this.children.forEach(child => {\n            let childElement = (child instanceof Element) ? child.render() : document.createTextNode(child)\n            element.appendChild(childElement)\n        });\n        return element\n    }\n    setAttr = (element, attr, value) => {\n\n        switch (attr) {\n            case \"style\":\n                element.style.cssText = value\n                break;\n            case \"value\":\n                let tagname = element.tagname.toLowerCase()\n                if (tagname === 'input' || tagname === \"textarea\") {\n                    element.value = value\n                } else {\n                    element.setAttribute(attr, value)\n                }\n                break;\n            default:\n                element.setAttribute(attr, value)\n                break;\n        }\n\n    }\n}\nexport default Element\n\n\n//使用\nimport ELement from './ELement'\n\nlet ul1 = new ELement(\n  'ul', {\n    class: 'nav'\n  },\n  [\n    new ELement(\n      'li', {\n        class: 'item'\n      },\n      ['1']\n    ),\n    new ELement(\n      'li', {\n        class: 'item'\n      },\n      ['2']\n    ),\n    new ELement(\n      'li', {\n        class: 'item'\n      },\n      ['3']\n    )\n  ]\n)\nlet root = ul1.render()\nexport default root\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br"),a("span",{staticClass:"line-number"},[n._v("35")]),a("br"),a("span",{staticClass:"line-number"},[n._v("36")]),a("br"),a("span",{staticClass:"line-number"},[n._v("37")]),a("br"),a("span",{staticClass:"line-number"},[n._v("38")]),a("br"),a("span",{staticClass:"line-number"},[n._v("39")]),a("br"),a("span",{staticClass:"line-number"},[n._v("40")]),a("br"),a("span",{staticClass:"line-number"},[n._v("41")]),a("br"),a("span",{staticClass:"line-number"},[n._v("42")]),a("br"),a("span",{staticClass:"line-number"},[n._v("43")]),a("br"),a("span",{staticClass:"line-number"},[n._v("44")]),a("br"),a("span",{staticClass:"line-number"},[n._v("45")]),a("br"),a("span",{staticClass:"line-number"},[n._v("46")]),a("br"),a("span",{staticClass:"line-number"},[n._v("47")]),a("br"),a("span",{staticClass:"line-number"},[n._v("48")]),a("br"),a("span",{staticClass:"line-number"},[n._v("49")]),a("br"),a("span",{staticClass:"line-number"},[n._v("50")]),a("br"),a("span",{staticClass:"line-number"},[n._v("51")]),a("br"),a("span",{staticClass:"line-number"},[n._v("52")]),a("br"),a("span",{staticClass:"line-number"},[n._v("53")]),a("br"),a("span",{staticClass:"line-number"},[n._v("54")]),a("br"),a("span",{staticClass:"line-number"},[n._v("55")]),a("br"),a("span",{staticClass:"line-number"},[n._v("56")]),a("br"),a("span",{staticClass:"line-number"},[n._v("57")]),a("br"),a("span",{staticClass:"line-number"},[n._v("58")]),a("br"),a("span",{staticClass:"line-number"},[n._v("59")]),a("br"),a("span",{staticClass:"line-number"},[n._v("60")]),a("br"),a("span",{staticClass:"line-number"},[n._v("61")]),a("br"),a("span",{staticClass:"line-number"},[n._v("62")]),a("br"),a("span",{staticClass:"line-number"},[n._v("63")]),a("br"),a("span",{staticClass:"line-number"},[n._v("64")]),a("br"),a("span",{staticClass:"line-number"},[n._v("65")]),a("br"),a("span",{staticClass:"line-number"},[n._v("66")]),a("br"),a("span",{staticClass:"line-number"},[n._v("67")]),a("br"),a("span",{staticClass:"line-number"},[n._v("68")]),a("br"),a("span",{staticClass:"line-number"},[n._v("69")]),a("br"),a("span",{staticClass:"line-number"},[n._v("70")]),a("br"),a("span",{staticClass:"line-number"},[n._v("71")]),a("br"),a("span",{staticClass:"line-number"},[n._v("72")]),a("br"),a("span",{staticClass:"line-number"},[n._v("73")]),a("br")])]),a("h2",{attrs:{id:"实现-dom-diff"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实现-dom-diff","aria-hidden":"true"}},[n._v("#")]),n._v(" 实现 DOM-diff")]),n._v(" "),a("p",[n._v("再 react 中只能实现同级别的 DOM 于虚拟 DOM 之间的比较 如果发生不同则修改，如果整个 DOM 移动到子节点下面，react 是感知不到的，react 会把整个子节点删除掉 然后重新生成子节点。")]),n._v(" "),a("ul",[a("li",[n._v("DOM 节点的跨层级移动操作特别少，可以忽略不计")]),n._v(" "),a("li",[n._v("拥有相同类的两个组件会生成相似的树形结构，拥有不同类的两个组件将会生成不同的树形结构")]),n._v(" "),a("li",[n._v("对于同一层级的一组节点，它们可以通过唯一的 key 进行区分,开发人员可以使用一个"),a("code",[n._v("key")]),n._v("指示在不同的渲染中那个那些元素可以保持稳定。")])])])},[],!1,null,null,null);s.default=t.exports}}]);